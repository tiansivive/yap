{"version":3,"sources":["../../../src/elaboration/inference/literal.ts"],"sourcesContent":["import * as EB from \"@yap/elaboration\";\nimport * as V2 from \"@yap/elaboration/shared/monad.v2\";\n\nimport * as F from \"fp-ts/lib/function\";\nimport * as Src from \"@yap/src/index\";\nimport { match } from \"ts-pattern\";\n\nimport * as Lit from \"@yap/shared/literals\";\nimport * as Q from \"@yap/shared/modalities/multiplicity\";\nimport { NF } from \"@yap/elaboration\";\n\ntype Literal = Extract<Src.Term, { type: \"lit\" }>;\n\nexport const infer = (lit: Literal): V2.Elaboration<EB.AST> =>\n\tV2.track(\n\t\t{ tag: \"src\", type: \"term\", term: lit, metadata: { action: \"infer\", description: \"Literal\" } },\n\t\tV2.Do(function* () {\n\t\t\tconst { value } = lit;\n\t\t\tconst ctx = yield* V2.ask();\n\t\t\tconst atom: Lit.Literal = match(value)\n\t\t\t\t.with({ type: \"String\" }, _ => Lit.Atom(\"String\"))\n\t\t\t\t.with({ type: \"Num\" }, _ => Lit.Atom(\"Num\"))\n\t\t\t\t.with({ type: \"Bool\" }, _ => Lit.Atom(\"Bool\"))\n\t\t\t\t.with({ type: \"unit\" }, _ => Lit.Atom(\"Unit\"))\n\t\t\t\t.with({ type: \"Atom\" }, _ => Lit.Atom(\"Type\"))\n\t\t\t\t.exhaustive();\n\n\t\t\treturn [EB.Constructors.Lit(value), NF.Constructors.Lit(atom), Q.noUsage(ctx.env.length)] satisfies EB.AST;\n\t\t}),\n\t);\n\ninfer.gen = F.flow(infer, V2.pure);\n"],"mappings":";AAAA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AAEpB,YAAY,OAAO;AAEnB,SAAS,aAAa;AAEtB,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB,SAAS,UAAU;AAIZ,MAAM,QAAQ,CAAC,QACrB,GAAG;AAAA,EACF,EAAE,KAAK,OAAO,MAAM,QAAQ,MAAM,KAAK,UAAU,EAAE,QAAQ,SAAS,aAAa,UAAU,EAAE;AAAA,EAC7F,GAAG,GAAG,aAAa;AAClB,UAAM,EAAE,MAAM,IAAI;AAClB,UAAM,MAAM,OAAO,GAAG,IAAI;AAC1B,UAAM,OAAoB,MAAM,KAAK,EACnC,KAAK,EAAE,MAAM,SAAS,GAAG,OAAK,IAAI,KAAK,QAAQ,CAAC,EAChD,KAAK,EAAE,MAAM,MAAM,GAAG,OAAK,IAAI,KAAK,KAAK,CAAC,EAC1C,KAAK,EAAE,MAAM,OAAO,GAAG,OAAK,IAAI,KAAK,MAAM,CAAC,EAC5C,KAAK,EAAE,MAAM,OAAO,GAAG,OAAK,IAAI,KAAK,MAAM,CAAC,EAC5C,KAAK,EAAE,MAAM,OAAO,GAAG,OAAK,IAAI,KAAK,MAAM,CAAC,EAC5C,WAAW;AAEb,WAAO,CAAC,GAAG,aAAa,IAAI,KAAK,GAAG,GAAG,aAAa,IAAI,IAAI,GAAG,EAAE,QAAQ,IAAI,IAAI,MAAM,CAAC;AAAA,EACzF,CAAC;AACF;AAED,MAAM,MAAM,EAAE,KAAK,OAAO,GAAG,IAAI;","names":[]}