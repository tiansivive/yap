{"version":3,"sources":["../../../src/elaboration/shared/errors.ts"],"sourcesContent":["import * as NF from \"@yap/elaboration/normalization\";\nimport * as R from \"@yap/shared/rows\";\nimport * as Q from \"@yap/shared/modalities/multiplicity\";\nimport * as EB from \"@yap/elaboration\";\n\nexport type Cause =\n\t| { type: \"UnificationFailure\"; left: NF.Value; right: NF.Value }\n\t| { type: \"RigidVariableMismatch\"; left: NF.Value; right: NF.Value }\n\t| { type: \"RowMismatch\"; left: NF.Row; right: NF.Row; reason: string }\n\t| { type: \"MissingLabel\"; label: string; row: NF.Row }\n\t| { type: \"TypeMismatch\"; left: NF.Value; right: NF.Value }\n\t| { type: \"Impossible\"; message: string; extra?: any }\n\t| { type: \"MultiplicityMismatch\"; expected: Q.Multiplicity; right: Q.Multiplicity; reason?: string };\n\nexport const UnificationFailure = (left: NF.Value, right: NF.Value): Cause => ({ type: \"UnificationFailure\", left, right });\nexport const RigidVariableMismatch = (left: NF.Value, right: NF.Value): Cause => ({ type: \"RigidVariableMismatch\", left, right });\nexport const RowMismatch = (left: NF.Row, right: NF.Row, reason: string): Cause => ({ type: \"RowMismatch\", left, right, reason });\nexport const TypeMismatch = (left: NF.Value, right: NF.Value): Cause => ({ type: \"TypeMismatch\", left, right });\nexport const Impossible = (message: string, extra?: any): Cause => ({ type: \"Impossible\", message, extra });\nexport const MissingLabel = (label: string, row: NF.Row): Cause => ({ type: \"MissingLabel\", label, row });\nexport const MultiplicityMismatch = (expected: Q.Multiplicity, right: Q.Multiplicity, reason?: string): Cause => ({\n\ttype: \"MultiplicityMismatch\",\n\texpected,\n\tright,\n\treason,\n});\n\nexport const display = (error: Cause, zonker: EB.Zonker, metas: EB.Context[\"metas\"]): string => {\n\tconst ctx = { zonker, metas, env: [] };\n\tswitch (error.type) {\n\t\tcase \"UnificationFailure\":\n\t\t\treturn `Unification Failure: Cannot unify ${NF.display(error.left, ctx)} with ${NF.display(error.right, ctx)}`;\n\t\tcase \"RigidVariableMismatch\":\n\t\t\treturn `Variable Mismatch: Cannot unify ${NF.display(error.left, ctx)} with ${NF.display(error.right, ctx)}`;\n\t\tcase \"RowMismatch\":\n\t\t\treturn `Row Mismatch: Cannot unify\\n${R.display<NF.Value, NF.Variable>({ term: v => NF.display(v, ctx), var: v => JSON.stringify(v) })(error.left)}\\nwith\\n${R.display<NF.Value, NF.Variable>({ term: v => NF.display(v, ctx), var: v => JSON.stringify(v) })(error.right)}.\\nReason: ${error.reason}`;\n\t\tcase \"TypeMismatch\":\n\t\t\treturn `Type Mismatch: Cannot unify:\\n\\t${NF.display(error.left, ctx)}\\nwith\\n\\t${NF.display(error.right, ctx)}`;\n\t\tcase \"Impossible\":\n\t\t\treturn `Impossible! ${error.message}`;\n\t\tcase \"MissingLabel\":\n\t\t\treturn `Missing Label: ${error.label}`;\n\t\tcase \"MultiplicityMismatch\":\n\t\t\treturn `Multiplicity Mismatch: Expected \"${Q.display(error.expected)}\" but got \"${Q.display(error.right)}\".`;\n\t}\n};\n"],"mappings":";AAAA,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,OAAO;AAYZ,MAAM,qBAAqB,CAAC,MAAgB,WAA4B,EAAE,MAAM,sBAAsB,MAAM,MAAM;AAClH,MAAM,wBAAwB,CAAC,MAAgB,WAA4B,EAAE,MAAM,yBAAyB,MAAM,MAAM;AACxH,MAAM,cAAc,CAAC,MAAc,OAAe,YAA2B,EAAE,MAAM,eAAe,MAAM,OAAO,OAAO;AACxH,MAAM,eAAe,CAAC,MAAgB,WAA4B,EAAE,MAAM,gBAAgB,MAAM,MAAM;AACtG,MAAM,aAAa,CAAC,SAAiB,WAAwB,EAAE,MAAM,cAAc,SAAS,MAAM;AAClG,MAAM,eAAe,CAAC,OAAe,SAAwB,EAAE,MAAM,gBAAgB,OAAO,IAAI;AAChG,MAAM,uBAAuB,CAAC,UAA0B,OAAuB,YAA4B;AAAA,EACjH,MAAM;AAAA,EACN;AAAA,EACA;AAAA,EACA;AACD;AAEO,MAAM,UAAU,CAAC,OAAc,QAAmB,UAAuC;AAC/F,QAAM,MAAM,EAAE,QAAQ,OAAO,KAAK,CAAC,EAAE;AACrC,UAAQ,MAAM,MAAM;AAAA,IACnB,KAAK;AACJ,aAAO,qCAAqC,GAAG,QAAQ,MAAM,MAAM,GAAG,CAAC,SAAS,GAAG,QAAQ,MAAM,OAAO,GAAG,CAAC;AAAA,IAC7G,KAAK;AACJ,aAAO,mCAAmC,GAAG,QAAQ,MAAM,MAAM,GAAG,CAAC,SAAS,GAAG,QAAQ,MAAM,OAAO,GAAG,CAAC;AAAA,IAC3G,KAAK;AACJ,aAAO;AAAA,EAA+B,EAAE,QAA+B,EAAE,MAAM,OAAK,GAAG,QAAQ,GAAG,GAAG,GAAG,KAAK,OAAK,KAAK,UAAU,CAAC,EAAE,CAAC,EAAE,MAAM,IAAI,CAAC;AAAA;AAAA,EAAW,EAAE,QAA+B,EAAE,MAAM,OAAK,GAAG,QAAQ,GAAG,GAAG,GAAG,KAAK,OAAK,KAAK,UAAU,CAAC,EAAE,CAAC,EAAE,MAAM,KAAK,CAAC;AAAA,UAAc,MAAM,MAAM;AAAA,IACrS,KAAK;AACJ,aAAO;AAAA,GAAmC,GAAG,QAAQ,MAAM,MAAM,GAAG,CAAC;AAAA;AAAA,GAAa,GAAG,QAAQ,MAAM,OAAO,GAAG,CAAC;AAAA,IAC/G,KAAK;AACJ,aAAO,eAAe,MAAM,OAAO;AAAA,IACpC,KAAK;AACJ,aAAO,kBAAkB,MAAM,KAAK;AAAA,IACrC,KAAK;AACJ,aAAO,oCAAoC,EAAE,QAAQ,MAAM,QAAQ,CAAC,cAAc,EAAE,QAAQ,MAAM,KAAK,CAAC;AAAA,EAC1G;AACD;","names":[]}