{"version":3,"sources":["../src/compile.ts"],"sourcesContent":["import * as Mod from \"./modules/loading\";\nimport * as CG from \"./Codegen/modules\";\n\nimport fs from \"fs\";\nimport beautify from \"js-beautify\";\n\nexport type Options = {\n\toutDir: string;\n\tbaseUrl: string;\n};\n\nexport const GlobalDefaults: Options = {\n\toutDir: \"./bin/\",\n\tbaseUrl: \"./yap/\",\n};\n\nexport const compile = (file: string, options: Options) => {\n\ttry {\n\t\tconst _ = Mod.mkInterface(file, [], options);\n\n\t\tObject.entries(Mod.globalModules).forEach(([filepath, iface]) => {\n\t\t\tconsole.log(\"Loaded module: \" + filepath);\n\t\t\t// const code = CG.codegen(iface, filepath);\n\t\t\t// const formatted = beautify.js(code, { indent_size: 2 });\n\t\t\tconst FFIfile = filepath.replace(\".yap\", \".ffi.js\");\n\n\t\t\tconst path = options.baseUrl + FFIfile;\n\t\t\tif (fs.existsSync(path)) {\n\t\t\t\tfs.copyFileSync(path, options.outDir + FFIfile.split(\"/\").pop());\n\t\t\t}\n\n\t\t\t// const outfile = filepath.replace(\".yap\", \".js\");\n\t\t\t// console.log(\"Writing: \" + outfile);\n\t\t\t// fs.writeFileSync(options.outDir + outfile.split(\"/\").pop(), formatted);\n\t\t\t// console.log(\"Generated: \" + outfile);\n\t\t});\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n};\n"],"mappings":";AAAA,YAAY,SAAS;AAGrB,OAAO,QAAQ;AAQR,MAAM,iBAA0B;AAAA,EACtC,QAAQ;AAAA,EACR,SAAS;AACV;AAEO,MAAM,UAAU,CAAC,MAAc,YAAqB;AAC1D,MAAI;AACH,UAAM,IAAI,IAAI,YAAY,MAAM,CAAC,GAAG,OAAO;AAE3C,WAAO,QAAQ,IAAI,aAAa,EAAE,QAAQ,CAAC,CAAC,UAAU,KAAK,MAAM;AAChE,cAAQ,IAAI,oBAAoB,QAAQ;AAGxC,YAAM,UAAU,SAAS,QAAQ,QAAQ,SAAS;AAElD,YAAM,OAAO,QAAQ,UAAU;AAC/B,UAAI,GAAG,WAAW,IAAI,GAAG;AACxB,WAAG,aAAa,MAAM,QAAQ,SAAS,QAAQ,MAAM,GAAG,EAAE,IAAI,CAAC;AAAA,MAChE;AAAA,IAMD,CAAC;AAAA,EACF,SAAS,GAAG;AACX,YAAQ,MAAM,CAAC;AAAA,EAChB;AACD;","names":[]}